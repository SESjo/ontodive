<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ontodive">
<title>netCDF 101 • ontodive</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="netCDF 101">
<meta property="og:description" content="ontodive">
<meta property="og:image" content="sesjo.github.io/ontodive/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ontodive</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Seals</h6>
    <a class="dropdown-item" href="../articles/plot_presentation.html">Individuals Info</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Paper</h6>
    <a class="dropdown-item" href="../articles/figures.html">Figures</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Data Exploration</h6>
    <a class="dropdown-item" href="../articles/data_exploration_2018.html">Data Exploration NES (1/2) - 2018</a>
    <a class="dropdown-item" href="../articles/data_exploration_2018_map.html">Data Exploration NES (2/2) - 2018</a>
    <a class="dropdown-item" href="../articles/data_exploration_ses_2014.html">Data Exploration SES - 2014</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Others</h6>
    <a class="dropdown-item" href="../articles/create_logo.html">Logo Design</a>
    <a class="dropdown-item" href="../articles/phase_of_the_day.html">Detect phases of the day</a>
    <a class="dropdown-item" href="../articles/netcdf_read.html">netCDF 101</a>
    <a class="dropdown-item" href="../articles/buoyancy_detect.html">Changes in Buoyancy Detection</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Troubleshooting</h6>
    <a class="dropdown-item" href="../articles/session_info.html">R Session Info</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sesjo/ontodive/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="netcdf_read_files/kePrint-0.0.1/kePrint.js"></script><link href="netcdf_read_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>netCDF 101</h1>
                        <h4 data-toc-skip class="author">Joffrey
JOUMAA</h4>
            
            <h4 data-toc-skip class="date">August 22, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sesjo/ontodive/blob/HEAD/vignettes/netcdf_read.Rmd" class="external-link"><code>vignettes/netcdf_read.Rmd</code></a></small>
      <div class="d-none name"><code>netcdf_read.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="whats-a-netcdf-file">What’s a netCDF file?<a class="anchor" aria-label="anchor" href="#whats-a-netcdf-file"></a>
</h2>
<blockquote>
<p>NetCDF (Network Common Data Form) is a set of software libraries and
self-describing, machine-independent data formats that support the
creation, access, and sharing of array-oriented scientific data. The
project homepage<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="https://www.unidata.ucar.edu/software/netcdf/" class="external-link"&gt;https://www.unidata.ucar.edu/software/netcdf/&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a> is hosted by the Unidata program at the
University Corporation for Atmospheric Research (UCAR). They are also
the chief source of netCDF software, standards development, updates,
etc. The format is an open standard. NetCDF Classic and 64-bit Offset
Format are an international standard of the Open Geospatial
Consortium.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="https://www.ogc.org/standards/netcdf" class="external-link"&gt;https://www.ogc.org/standards/netcdf&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a></p>
<p>– <cite><a href="https://en.wikipedia.org/wiki/NetCDF" class="external-link">Wikipedia</a></cite></p>
</blockquote>
<p>The way I see a netCDF file is that it’s a matrix that usually
contains environmental data across time and location, plus extra
information (called <em>metadata</em>) such as where does the dataset
comes from, or its resolution.</p>
<div class="float">
<img src="https://web.itu.edu.tr/~tokerem/Presentation/netcdf_1.png" alt="Here is an example of the structure of a netCDF file containing information on temperature and pressure accross time for several location, but also on the elevation and the land cover"><div class="figcaption">Here is an example<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="https://web.itu.edu.tr/~tokerem/netcdf.html" class="external-link"&gt;https://web.itu.edu.tr/~tokerem/netcdf.html&lt;/a&gt;&lt;/p&gt;'><sup>3</sup></a> of the structure of a
netCDF file containing information on temperature and pressure accross
time for several location, but also on the elevation and the land
cover</div>
</div>
</div>
<div class="section level2">
<h2 id="how-to-open-it">How to open it?<a class="anchor" aria-label="anchor" href="#how-to-open-it"></a>
</h2>
<p>Super simple, using the <a href="https://cran.r-project.org/web/packages/ncdf4/index.html" class="external-link"><code>tidync</code></a>
package! Let’s say you have a netcdf file called
<strong>global-reanalysis-phy-001-031-grepv2-daily_1639765258612.nc</strong>,
here is what you have to do to import this file:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first load `tidync` package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https...ropensci.org/tidync/" class="external-link">tidync</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># then import your file</span></span>
<span><span class="va">df_nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https...ropensci.org/tidync/reference/tidync.html" class="external-link">tidync</a></span><span class="op">(</span><span class="st">"../inst/extdata/copernicus/global-reanalysis-phy-001-031-grepv2-daily_1639765258612.nc"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># flatten the multidimensional array</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_nc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># extract NetCDF data as an expanded table</span></span>
<span>  <span class="fu"><a href="https...ropensci.org/tidync/reference/hyper_tibble.html" class="external-link">hyper_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># not mandatory, but here is the code to convert to a data.table</span></span>
<span>  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html" class="external-link">setDT</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print the first 10 rows</span></span>
<span><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>, <span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">sable</span><span class="op">(</span></span>
<span>    caption <span class="op">=</span> <span class="st">"First 10 rows of the flatten netCDF file"</span>,</span>
<span>    digits <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<table class="table table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
First 10 rows of the flatten netCDF file
</caption>
<thead><tr>
<th style="text-align:right;">
uo_cglo
</th>
<th style="text-align:right;">
uo_glor
</th>
<th style="text-align:right;">
vo_oras
</th>
<th style="text-align:right;">
uo_foam
</th>
<th style="text-align:right;">
vo_glor
</th>
<th style="text-align:right;">
uo_oras
</th>
<th style="text-align:right;">
vo_cglo
</th>
<th style="text-align:right;">
vo_foam
</th>
<th style="text-align:right;">
longitude
</th>
<th style="text-align:right;">
latitude
</th>
<th style="text-align:right;">
depth
</th>
<th style="text-align:right;">
time
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
-140.00
</td>
<td style="text-align:right;">
51.00
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
25148
</td>
</tr>
<tr>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
-127.00
</td>
<td style="text-align:right;">
43.50
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
25161
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
-0.23
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
-130.25
</td>
<td style="text-align:right;">
36.75
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
25400
</td>
</tr>
<tr>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
-131.75
</td>
<td style="text-align:right;">
27.75
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
25078
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-156.25
</td>
<td style="text-align:right;">
30.00
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
25363
</td>
</tr>
<tr>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
-136.00
</td>
<td style="text-align:right;">
35.50
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
25382
</td>
</tr>
<tr>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
-152.75
</td>
<td style="text-align:right;">
48.25
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
25284
</td>
</tr>
<tr>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-149.25
</td>
<td style="text-align:right;">
28.25
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
25240
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-127.00
</td>
<td style="text-align:right;">
43.50
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
25314
</td>
</tr>
<tr>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
-160.50
</td>
<td style="text-align:right;">
40.75
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
25164
</td>
</tr>
</tbody>
</table>
<p>Now we can see that the time is not in a proper format. The first
thing to do is to look into the metadata to see if we could find some
kind of explanation. To do that, we’re going to use the
<code>ncmeta</code> package, developped for this purpose.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load ncmeta library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hypertidy/ncmeta" class="external-link">ncmeta</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># then we use the function nc_atts to access attributes of times</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ncmeta/man/nc_atts.html" class="external-link">nc_atts</a></span><span class="op">(</span></span>
<span>    <span class="st">"../inst/extdata/copernicus/global-reanalysis-phy-001-031-grepv2-daily_1639765258612.nc"</span>,</span>
<span>    <span class="st">"time"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># we want information on the unit for time column</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">==</span> <span class="st">"units"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $units</span></span>
<span><span class="co">## [1] "days since 1950-01-01 00:00:00"</span></span></code></pre>
<p>The column <code>time</code> seems to be the number of days since
<code>1950-01-01</code>. Let’s use that information to format the
<code>time</code> column in a proper way.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># convert time into a readable format</span></span>
<span><span class="va">df</span><span class="op">[</span>, <span class="va">time</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">time</span>, origin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1950-01-01"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># print</span></span>
<span><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>, <span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">sable</span><span class="op">(</span></span>
<span>    caption <span class="op">=</span> <span class="st">"First 10 rows of the flatten netCDF file, with reformat time column"</span>,</span>
<span>    digits <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<table class="table table table-striped table-hover table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
First 10 rows of the flatten netCDF file, with reformat time column
</caption>
<thead><tr>
<th style="text-align:right;">
uo_cglo
</th>
<th style="text-align:right;">
uo_glor
</th>
<th style="text-align:right;">
vo_oras
</th>
<th style="text-align:right;">
uo_foam
</th>
<th style="text-align:right;">
vo_glor
</th>
<th style="text-align:right;">
uo_oras
</th>
<th style="text-align:right;">
vo_cglo
</th>
<th style="text-align:right;">
vo_foam
</th>
<th style="text-align:right;">
longitude
</th>
<th style="text-align:right;">
latitude
</th>
<th style="text-align:right;">
depth
</th>
<th style="text-align:left;">
time
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-141.50
</td>
<td style="text-align:right;">
50.25
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:left;">
2019-01-02
</td>
</tr>
<tr>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-138.50
</td>
<td style="text-align:right;">
27.50
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:left;">
2018-07-25
</td>
</tr>
<tr>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
-143.50
</td>
<td style="text-align:right;">
29.00
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:left;">
2018-11-30
</td>
</tr>
<tr>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-133.50
</td>
<td style="text-align:right;">
41.00
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:left;">
2019-02-28
</td>
</tr>
<tr>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-154.00
</td>
<td style="text-align:right;">
52.75
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:left;">
2018-07-26
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-129.25
</td>
<td style="text-align:right;">
37.25
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:left;">
2019-06-07
</td>
</tr>
<tr>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-152.50
</td>
<td style="text-align:right;">
44.75
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:left;">
2019-03-09
</td>
</tr>
<tr>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-133.75
</td>
<td style="text-align:right;">
47.75
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:left;">
2018-05-07
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-139.00
</td>
<td style="text-align:right;">
51.75
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:left;">
2018-07-07
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
-127.00
</td>
<td style="text-align:right;">
28.75
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:left;">
2018-07-03
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="how-to-visualize-it">How to visualize it?<a class="anchor" aria-label="anchor" href="#how-to-visualize-it"></a>
</h2>
<p>Well there are plenty of ways to display data within a netCDF. Here,
we are only presenting one simple way to do it using
<code>ggplot2</code> and <code>gganimate</code> package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first let's calculate the velocity norm</span></span>
<span><span class="va">df</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span></span>
<span>  vel_cglo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">uo_cglo</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">vo_cglo</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  vel_oras <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">uo_oras</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">vo_oras</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  vel_foam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">uo_foam</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">vo_foam</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  vel_glor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">uo_glor</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">vo_glor</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  month <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">month</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,</span>
<span>  year <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">year</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># average by month</span></span>
<span><span class="va">df_summarize</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span></span>
<span>  vel_cglo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">vel_cglo</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  vel_oras <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">vel_oras</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  vel_foam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">vel_foam</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  vel_glor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">vel_glor</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">)</span>,</span>
<span>by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">year</span>, <span class="st">"-"</span>, <span class="va">month</span><span class="op">)</span>,</span>
<span>  <span class="va">longitude</span>,</span>
<span>  <span class="va">latitude</span></span>
<span><span class="op">)</span></span>
<span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">.</span><span class="op">[</span>, <span class="va">time</span> <span class="op">:=</span> <span class="va">.GRP</span>, by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># data wrangling</span></span>
<span><span class="va">dataPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/melt.data.table.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">df_summarize</span>,</span>
<span>  id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"longitude"</span>, <span class="st">"latitude"</span>, <span class="st">"time"</span><span class="op">)</span>,</span>
<span>  variable.name <span class="op">=</span> <span class="st">"model"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># let's comput the ouput of all models</span></span>
<span><span class="va">res_anim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">dataPlot</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">longitude</span>, y <span class="op">=</span> <span class="va">latitude</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span>,</span>
<span>    interpolate <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu">spData</span><span class="fu">::</span><span class="va"><a href="https://jakubnowosad.com/spData/reference/world.html" class="external-link">world</a></span>,</span>
<span>    col <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"ivory"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">165</span>, <span class="op">-</span><span class="fl">115</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">55</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">model</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_jjo.html">theme_jjo</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu">oce</span><span class="fu">::</span><span class="fu"><a href="https://dankelley.github.io/oce/reference/oceColorsJet.html" class="external-link">oceColors9A</a></span><span class="op">(</span><span class="fl">120</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Date: {df_summarize[,unique(date)][frame_time]}"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">transition_time</span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ease_aes</span><span class="op">(</span><span class="st">"linear"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># let's print</span></span>
<span><span class="fu">animate</span><span class="op">(</span><span class="va">res_anim</span>, height <span class="op">=</span> <span class="fl">500</span>, width <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="../articles/netcdf_read_files/figure-html/netcdf-read-7-1.gif" alt="4 models of the current velocity in the North-East part of Pacific ocean" width="100%"><p class="caption">
4 models of the current velocity in the North-East part of Pacific ocean
</p>
</div>
<p>Four different GIFs, since there are four different models to get the
SST: <img src="https://i.imgur.com/3OOofoP.png" alt="Table from Copernicus"></p>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://www.linkedin.com/in/joffreyjoumaa" class="external-link">Joffrey Joumaa</a>, <a href="https://www.eeb.ucsc.edu/about/dept-directory.php?uid=rsbeltra" class="external-link">Roxanne Beltran</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
